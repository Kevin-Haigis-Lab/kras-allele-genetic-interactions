<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Comutation of KRAS">

  
  
  
    
  
  <meta name="description" content="RC Co-mutation test Introduction A while back, I thought of using the RC-test for co-mutation and mutual exclusivity from A weighted exact test for mutually exclusive mutations in cancer (Leiserson et al., 2016) in place of the Fisher&rsquo;s exact test that Giorgio had employed. The benefit of this test is that it accounts for the number of mutations per sample in its estimate of significance. The main draw back is that it is permutation-based, and thus very slow.">

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/post/2019-10-07/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.a3cda781a9b24f26fefd34a53547835b.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="http://localhost:1313/post/2019-10-07/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="KRAS Comutation">
  <meta property="og:url" content="http://localhost:1313/post/2019-10-07/">
  <meta property="og:title" content="2019-10-07 | KRAS Comutation">
  <meta property="og:description" content="RC Co-mutation test Introduction A while back, I thought of using the RC-test for co-mutation and mutual exclusivity from A weighted exact test for mutually exclusive mutations in cancer (Leiserson et al., 2016) in place of the Fisher&rsquo;s exact test that Giorgio had employed. The benefit of this test is that it accounts for the number of mutations per sample in its estimate of significance. The main draw back is that it is permutation-based, and thus very slow."><meta property="og:image" content="http://localhost:1313/img/icon-192.png">
  <meta property="twitter:image" content="http://localhost:1313/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-10-07T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-10-07T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/2019-10-07/"
  },
  "headline": "2019-10-07",
  
  "datePublished": "2019-10-07T00:00:00Z",
  "dateModified": "2019-10-07T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Comutation of KRAS"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "KRAS Comutation",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/img/icon-512.png"
    }
  },
  "description": "RC Co-mutation test Introduction A while back, I thought of using the RC-test for co-mutation and mutual exclusivity from A weighted exact test for mutually exclusive mutations in cancer (Leiserson et al., 2016) in place of the Fisher\u0026rsquo;s exact test that Giorgio had employed. The benefit of this test is that it accounts for the number of mutations per sample in its estimate of significance. The main draw back is that it is permutation-based, and thus very slow."
}
</script>

  

  


  


  





  <title>2019-10-07 | KRAS Comutation</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">KRAS Comutation</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#notebook"><span>Notebook</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#timeline"><span>Timeline</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>2019-10-07</h1>

  

  
    



<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Oct 7, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  
  

  
  

  
    

  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      

<h1 id="rc-co-mutation-test">RC Co-mutation test</h1>

<h2 id="introduction">Introduction</h2>

<p>A while back, I thought of using the RC-test for co-mutation and mutual exclusivity from <a href="https://academic.oup.com/bioinformatics/article/32/17/i736/2450792/" target="_blank"><em>A weighted exact test for mutually exclusive mutations in cancer</em> (Leiserson <em>et al.</em>, 2016)</a> in place of the Fisher&rsquo;s exact test that Giorgio had employed.
The benefit of this test is that it accounts for the number of mutations <em>per sample</em> in its estimate of significance.
The main draw back is that it is permutation-based, and thus very slow.</p>

<p>I was able to write a <a href="https://snakemake.readthedocs.io" target="_blank">Snakemake</a> script to run the test for all cancers and <em>KRAS</em> alleles.
It has finally completed all of the tests and I will now port it over to this project.
To move forward with the analysis, I will just port over the results and begin parsing.
I will go back and move the files for running the analysis over in the future.
For now, it is located on O2 at the following URL: &ldquo;/n/data2/bidmc/medicine/haigis/Cook/KrasComutation/FinalAnalyses/RC_comutation_2/&rdquo;</p>

<h2 id="munging">Munging</h2>

<p>I copied the directory of the output of the RC-test into the data dir.</p>

<pre><code class="language-bash">mkdir data/rc-test-results
cp -r ../KrasComutation/FinalAnalyses/RC_comutation_2/output/* data/rc-test-results
</code></pre>

<p>These files are automatically loaded into R by running <code>load.project()</code>.
I combined all of the information into a single data frame, <code>rc_test_results</code>, in the munging script &ldquo;30_rc-test_results-prep.R&rdquo;.
Here, I also extracted the non-<em>KRAS</em> gene from the <code>gene_set</code> column.
The raw files were added to the list of raw data to ignore in &ldquo;config/global.dcf&rdquo;.</p>

<h2 id="analyzing-rc-test-results">Analyzing RC-test results</h2>

<h3 id="general-scope-of-results">General scope of results</h3>

<p>Below is the number of significant interactions (p-value &lt; 0.05 and at-least 3 events) per cancer found by the RC-test.</p>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/sig_results_barplot.svg" alt="" /></p>

<p>The plot below separates the bars by the type of interaction.</p>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/sig_results_barplot_septest.svg" alt="" /></p>

<h3 id="interaction-networks">Interaction networks</h3>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/COAD_comut-mutex_network.svg" alt="" /></p>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/LUAD_comut-mutex_network.svg" alt="" /></p>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/PAAD_comut-mutex_network.svg" alt="" /></p>

<p><img src="/img/graphs/20_30_rc-test-results-analysis/MM_comut-mutex_network.svg" alt="" /></p>

<h2 id="moving-the-rc-test-directory-to-this-project">Moving the RC-test directory to this project</h2>

<p>I got this far and decided that moving forward with any analysis would require a lot of the information from the RC-test directory.
Therefore, I stopped and ported it over.
The following are the steps I took.</p>

<h3 id="moving-input-intermediate-and-output-data">Moving input, intermediate, and output data</h3>

<pre><code class="language-bash">mkdir data/rc-test
mkdir data/rc-test/input  data/rc-test/intermediate data/rc-test/output
</code></pre>

<pre><code class="language-bash">cp ../KrasComutation/FinalAnalyses/RC_comutation_2/input/* data/rc-test/input/
cp ../KrasComutation/FinalAnalyses/RC_comutation_2/intermediate/* data/rc-test/intermediate/
cp -r ../KrasComutation/FinalAnalyses/RC_comutation_2/output/* data/rc-test/output/
cp -r ../KrasComutation/FinalAnalyses/RC_comutation_2/permuted_graphs data/rc-test/
</code></pre>

<h3 id="moving-example-dag-image">Moving example DAG image</h3>

<pre><code class="language-bash">cp ../KrasComutation/FinalAnalyses/RC_comutation_2/images/dag.pdf graphs/20_20_rc-test_Snakefile/
</code></pre>

<h3 id="moving-scripts">Moving scripts</h3>

<pre><code class="language-bash">cp ../KrasComutation/FinalAnalyses/RC_comutation_2/Snakefile src/20_20_rc-test_Snakefile
cp ../KrasComutation/FinalAnalyses/RC_comutation_2/snakemake_scripts/* src/
cp ../KrasComutation/FinalAnalyses/RC_comutation_2/prepare_input_tables.R src/
cp ../KrasComutation/FinalAnalyses/RC_comutation_2/generate_sm_output_names.R src
cp ../KrasComutation/FinalAnalyses/RC_comutation_2/cluster.json config/

</code></pre>

<p>The snakemake scripts were renamed.
I did my best to update the Snakefile for the new directory, but real testing will be required to truly find out.
A bash script was created to run the Snakemake file on O2, &ldquo;20_21_run-rc-test-snakemake.sh&rdquo;.</p>

<h2 id="munging-cancer-data-from-giorgio-melloni">Munging cancer data from Giorgio Melloni</h2>

<p>GM used a deeply-nested data structure for the cancer data.
His format is not conducive to my coding style (and is very large).
I created another munging script to prepare this data, &ldquo;20_prepare-cancer-data.R&rdquo;.
The files from GM were copied from the old directory to &ldquo;data/cancer-data/&rdquo;.</p>

    </div>

    


    



    
      








  






  
  
  
  
  <div class="media author-card">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu3d2b6d52e0d21b58bf5a8ffa816d54c8_538771_250x250_fill_lanczos_center_2.png" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/admin/">Comutation of KRAS</a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://github.com/jhrcook/comutation" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    


  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js" integrity="sha256-0w92bcB21IY5+rGI84MGj52jNfHNbXVeQLrZ0CGdjNY=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/sh.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/swift.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.0bf1e3db85cbb232372ed31d6f10dc70.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10&v=2"></' + 'script>')</script></body>
</html>
